{% extends 'base.html' %}

{% block content %}
<h2 class='stk-title'>{{stk_info['longName']}}({{stk_info['symbol']}})</h2>
<div class='container tit'>
  <h4><span id='open'>{{stk_info['open']}}</span> <span id='chng'>{{'%0.2f'| format(hist_data[0][8]|float)}}</span> <span id='perchng'>({{'%0.2f'| format(hist_data[0][9]|float)}}%)</span></h4>
  <script>
        var elem = document.getElementById('chng')
        var elem_val = document.getElementById('chng').innerText;

        var ew =   document.getElementById('perchng')
        var ew_val = document.getElementById('perchng').innerText;

        var x = parseInt(elem_val)

        if(x<0) {
            if (elem.className == 'green'){
              elem.className += "red";
            }
        }
        if(x>0) {
            if(elem.className == 'red'){
              elem.className += "green";
            }
        }
    </script>
</div>
<div class="container dropdown">
      <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        View Plot
      </button>
      <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
        <a class="dropdown-item" href="/plotmacd">MACD</a>
        <a class="dropdown-item" href="/plotline">Line</a>
        <a class="dropdown-item" href="/plotcandle">Candle</a>
      </div>
  </div>
<div id="stock-info">
  
  <div id="stock-left-col">
    <div class="tableLine">
      <div class="label">Prev Close:</div>
      <div class="value stockPrevClose">{{stk_info['previousClose']}}</div>
    </div>
    <div class="tableLine">
      <div class="label">Open:</div>
      <div class="value stockOpen">{{stk_info['open']}}</div>
    </div>
    <div class="tableLine">
      <div class="label">Bid:</div>
      <div class="value stockBid">{{stk_info['bid']}}</div>
    </div>
    <div class="tableLine">
      <div class="label">Ask:</div>
      <div class="value stockAsk">{{stk_info['ask']}}</div>
    </div>
    <div class="tableLine">
      <div class="label">Beta 3 Year:</div>
      <div class="value stockTargetEst">{{stk_info['beta3Year']}}</div>
    </div>
    <div class="tableLine">
      <div class="label">SMA (30 days):</div>
      <div class="value stockDayLow">{{'%0.2f'| format(sma|float)}}</div>
    </div>
  </div>
  
  <div id="stock-right-col">
  <div class="tableLine">
      <div class="label">Volume: </div>
      <div class="value stockVolume">{{stk_info['volume']}}</div>
    </div>
    <div class="tableLine">
      <div class="label">Avg Volume: </div>
      <div class="value stockAvgVolume">{{stk_info['averageVolume']}}</div>
    </div>
    <div class="tableLine">
      <div class="label">Market Cap:</div>
      <div class="value stockMarketCap">{{stk_info['marketCap']}}</div>
    </div>
    <div class="tableLine">
      <div class="label">Day High: </div>
      <div class="value stockDayHigh">{{stk_info['dayHigh']}}</div>
    </div>
    <div class="tableLine">
      <div class="label">Day Low: </div>
      <div class="value stockDayLow">{{stk_info['dayLow']}}</div>
    </div>
    <div class="tableLine">
      <div class="label">RSI (30 days):</div>
      <div class="value stockDayLow">{{'%0.2f'| format(rsi|float)}}</div>
    </div>
  </div>

</div>

<div class='table-wrapper'>
  <table class="table table-striped table-sm">
    <thead>
      <tr class='tablehead'>
        <th class='column1'>Date</th>
        <th class='column2'>Open</th>
        <th class='column3'>High</th>
        <th class='column4'>Low</th>
        <th class='column5'>Close</th>
        <th class='column6'>Volume</th>
        <th class='column7'>Change</th>
        <th class='column8'>%Change</th>
      </tr>
    </thead>
    <tbody>
      {% for value in hist_data %}
      <tr>
        <td>{{ value[7] }}</td>
        <td>{{'%0.2f'| format(value[0]|float)}}</td>
        <td>{{'%0.4f'| format(value[1]|float)}}</td>
        <td>{{'%0.4f'| format(value[2]|float)}}</td>
        <td>{{'%0.2f'| format(value[3]|float)}}</td>
        <td>{{'%0.2f'| format(value[4]|float)}}</td>
        <td>{{'%0.2f'| format(value[8]|float)}}</td>
        <td>{{'%0.2f'| format(value[9]|float)}}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}